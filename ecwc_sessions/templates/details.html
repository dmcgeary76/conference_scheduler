{% extends 'base.html' %}
{% block content %}
{% load mathfilters %}
{% if request.user_agent.is_pc %}
  <div class="trg_det">
    <table class="center">
      <tbody>
        <tr>
          <td>Session Title: {{ sesh.title }}</td>
          <td>Presenter: {{ sesh.presenter }}</td>
          <td>Content Domain: {{ sesh.domain }}</td>
        </tr>
        <tr>
          <td>Room: {{ sesh.room }}</td>
          <td>Time: {{ sesh.time_slot }}</td>
          <td style="color:red;">Seats Remaining: {{ sesh.room_limit|sub:sesh.seats }}</td>
        <tr>
          <td colspan="3">{{ sesh.description|linebreaks }}</td>
        </tr>
        <tr>
          <td colspan="3">
            <form action='.' method='POST'>{% csrf_token %}
              <input type="hidden" name="time_slot" value="{{  sesh.time_slot }}"></input>
              <input type="hidden" name="session_id" value="{{ sesh.id }}"</input>
              <input type="hidden" name="user_id" value="{{ user.id }}"></input>
              <a class="nav-link" href="{% url 'list_all_view' sesh.time_slot %}">Back</a>
              {% if sesh.room_limit|sub:sesh.seats > 0 and not same_sesh %}
                <input type="submit" value="Register"></input>
              {% elif sesh.room_limit|sub:sesh.seats == 0 %}
                <div class="error_msg">There are no seats left in this session.</div>
              {% elif same_sesh %}
                <div class="error_msg">You are already registered for this session.</div>
              {% endif %}
            </form>
          </td>
        </tr>
        <tr colspan="3">
          {% if has_choice and sesh.room_limit > 0 and not same_sesh %}
            <div class="error_msg">You already have a session set for this time.  Registering for this session will drop your previous session from your schedule.</div>
          {% endif %}
        </tr>
      </tbody>
    </table>
    <p>
      {% if is_owner %}
        You are the presenter for this session!
      {% endif %}
      {% if user.is_staff %}
        <span style="color:pink;">You are an admin on this site. Don't abuse your awesome powers!</span>
      {% endif %}
    </p>
    <p>
      {% if is_owner or user.is_staff %}
        {% for attendee in attendees %}
          <p>{{ forloop.counter }}. {{ attendee.first_name }} {{ attendee.last_name }} - {{ attendee.email }}</p>
        {% endfor %}
      {% endif %}
    </p>
  </div>
{% else %}
  <div class="trg_det">
    <table class="center">
      <tbody>
        <tr class="det_mobile">
          <td>Session Title: {{ sesh.title }}</td>
          <td>Presenter: {{ sesh.presenter }}</td>
          <td>Content Domain: {{ sesh.domain }}</td>
        </tr>
        <tr class="det_mobile">
          <td>Room: {{ sesh.room }}</td>
          <td>Time: {{ sesh.time_slot }}</td>
          <td style="color:red;">Seats Remaining: {{ sesh.room_limit|sub:sesh.seats }}</td>
        <tr class="det_mobile">
          <td colspan="3">{{ sesh.description|linebreaks }}</td>
        </tr>
        <tr class="det_mobile">
          <td colspan="3">
            <form action='.' method='POST'>{% csrf_token %}
              <input type="hidden" name="time_slot" value="{{  sesh.time_slot }}"></input>
              <input type="hidden" name="session_id" value="{{ sesh.id }}"</input>
              <input type="hidden" name="user_id" value="{{ user.id }}"></input>
              <a class="nav-link" href="{% url 'list_all_view' sesh.time_slot %}">Back</a>
              {% if sesh.room_limit|sub:sesh.seats > 0 and not same_sesh %}
                <input type="submit" value="Register"></input>
              {% elif sesh.room_limit|sub:sesh.seats == 0 %}
                <div class="error_msg">There are no seats left in this session.</div>
              {% elif same_sesh %}
                <div class="error_msg">You are already registered for this session.</div>
              {% endif %}
            </form>
          </td>
        </tr>
        <tr colspan="3" class="det_mobile">
          {% if has_choice and sesh.room_limit > 0 and not same_sesh %}
            <div class="error_msg" style="font-size:28px;">You already have a session set for this time.  Registering for this session will drop your previous session from your schedule.</div>
          {% endif %}
        </tr>
      </tbody>
    </table>
    <p class="det_mobile">
      {% if is_owner %}
        You are the presenter for this session!
      {% endif %}
      {% if user.is_staff %}
        <span  class="det_mobile" style="color:pink;">You are an admin on this site. Don't abuse your awesome powers!</span>
      {% endif %}
    </p>
    <p class="det_mobile">
      {% if is_owner or user.is_staff %}
        {% for attendee in attendees %}
          <p class="det_mobile">{{ forloop.counter }}. {{ attendee.first_name }} {{ attendee.last_name }} - {{ attendee.email }}</p>
        {% endfor %}
      {% endif %}
    </p>
  </div>
{% endif %}
{% endblock %}
